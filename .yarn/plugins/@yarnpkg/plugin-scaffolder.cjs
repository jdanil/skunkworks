/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-scaffolder",
factory: function (require) {
var plugin=(()=>{var w=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var G=(t,e,a)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var g=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,a)=>(typeof require<"u"?require:e)[a]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var R=(t,e)=>()=>(t&&(e=t(t=0)),e);var T=(t,e)=>{for(var a in e)w(t,a,{get:e[a],enumerable:!0})},V=(t,e,a,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of M(e))!E.call(t,r)&&r!==a&&w(t,r,{get:()=>e[r],enumerable:!(o=D(e,r))||o.enumerable});return t};var W=t=>V(w({},"__esModule",{value:!0}),t);var y=(t,e,a)=>(G(t,typeof e!="symbol"?e+"":e,a),a),H=(t,e,a)=>{if(!e.has(t))throw TypeError("Cannot "+a)};var b=(t,e,a)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,a)};var k=(t,e,a)=>(H(t,e,"access private method"),a);var I={};T(I,{default:()=>F});function F(t,e){if(t===e)return 0;let a=t;t.length>e.length&&(t=e,e=a);let o=t.length,r=e.length;for(;o>0&&t.charCodeAt(~-o)===e.charCodeAt(~-r);)o--,r--;let i=0;for(;i<o&&t.charCodeAt(i)===e.charCodeAt(i);)i++;if(o-=i,r-=i,o===0)return r;let d,c,n,h,s=0,f=0;for(;s<o;)A[s]=t.charCodeAt(i+s),S[s]=++s;for(;f<r;)for(d=e.charCodeAt(i+f),n=f++,c=f,s=0;s<o;s++)h=d===A[s]?n:n+1,n=S[s],c=S[s]=n>c?h>c?c+1:h:h>n?n+1:h;return c}var S,A,J=R(()=>{S=[],A=[]});var X={};T(X,{default:()=>Q});var $=g("@yarnpkg/core");var v=g("child_process"),p=g("fs"),l=g("path"),U=g("@yarnpkg/cli"),j=g("@yarnpkg/core"),N=g("@yarnpkg/fslib"),m=g("clipanion");var C,q,P,L,x,O,u=class extends U.BaseCommand{constructor(){super(...arguments);b(this,C);b(this,P);b(this,x);y(this,"name",m.Option.String("--name",{description:"Name of the package (in kebab-case)",required:!0}));y(this,"template",m.Option.String("--template",{description:"Name of the template to use to bootstrap the package",required:!0}));y(this,"destination",m.Option.String("--destination",{description:"Destination path of the package",required:!1}))}async execute(){let a=await j.Configuration.find(this.context.cwd,this.context.plugins);if(!a.projectCwd)throw new m.UsageError("This command must be run from within a project folder.");let o=N.npath.fromPortablePath(a.projectCwd),{templates:r,source:i,destination:d}=await k(this,C,q).call(this,{configuration:a,projectCwd:o});if(!(0,p.existsSync)(i))throw new m.UsageError(`Invalid template "${this.template}"; source path does not exist. Please select from: ${(0,p.readdirSync)(r).join(", ")}.`);k(this,x,O).call(this,{destination:d,projectCwd:o,source:i})}};C=new WeakSet,q=async function({configuration:a,projectCwd:o}){let{project:r}=await j.Project.find(a,this.context.cwd),i=N.npath.fromPortablePath(this.context.cwd),d=(0,l.join)(o,r.configuration.get("scaffolderTemplateFolder")),c=(0,l.join)(d,this.template),{default:n}=await Promise.resolve().then(()=>(J(),I)),[h]=r.topLevelWorkspace.manifest.workspaceDefinitions.map(f=>f.pattern.replace("*","").replace(/(?<slash>\/)(?=\/*\1)/u,"").replace(/\/$/u,"")).sort((f,z)=>n(this.template,f)-n(this.template,z));return{destination:(0,l.join)(this.destination==null?h==null?i:(0,l.join)(o,h):this.destination==="."?i:(0,l.join)(o,this.destination),this.name),source:c,templates:d}},P=new WeakSet,L=function({destination:a,projectCwd:o}){let r=(0,l.join)(a,"package.json"),i=JSON.parse((0,p.readFileSync)(r,{encoding:"utf8"})),d=i.name?.replace(this.template,this.name),c=a.replace(o,"").split(l.sep).join(l.posix.sep).replaceAll(/^\//u,""),n=typeof i.repository=="object"?{...i.repository,directory:c}:i.repository;(0,p.writeFileSync)(r,JSON.stringify({...i,name:d,repository:n}))},x=new WeakSet,O=function({projectCwd:a,source:o,destination:r}){(0,p.cpSync)(o,r,{recursive:!0}),k(this,P,L).call(this,{destination:r,projectCwd:a}),(0,v.execSync)("yarn install",{cwd:a}),(0,v.execSync)("yarn format package.json --write",{cwd:r}),(0,v.execSync)("git add .",{cwd:r})},y(u,"paths",[["scaffolder","bootstrap"]]),y(u,"usage",m.Command.Usage({category:"Scaffolder commands",description:"bootstrap a new package from a template",details:"\n      This command will bootstrap a new package from a given template. Templates are sourced from the configured `scaffolderTemplateFolder`.\n\n      - If `--destination` is not set, the new package will be created under the closest matching workspace directory to the given template.\n\n      - If `--destination` is set, the new package will be created under the given directory.\n\n      - If `--destination` is set to `.`, the new package will be created under the current working directory.\n    ",examples:[["Create a new library package under the closest matching workspace directory to the given template","yarn scaffolder bootstrap --name=new-library --template=library"],["Create a new library package under the current working directory","yarn scaffolder bootstrap --name=new-library --template=library --destination=."],["Create a new library package under the given directory","yarn scaffolder bootstrap --name=new-library --template=library --destination=libraries"]]}));var K={commands:[u],configuration:{scaffolderTemplateFolder:{default:"templates",description:"The folder containing templates from which the scaffolder bases bootstrapped packages from.",isNullable:!1,type:$.SettingsType.STRING}}},Q=K;return W(X);})();
return plugin;
}
};
